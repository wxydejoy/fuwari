## 背景

![image](https://img.undf.top/ob/5a6e68e7ea68562b2499934f9f0402f4.png)

博客建立到现在已经近三年了，期间各种写作方式，各种主题，都折腾了不少，简单聊聊，分享一下。详细的操作方式这里就不啰嗦了，相信胆大心细的你肯定能解决。

## 关于设定

### 漂泊者
漂泊者是一个神秘的旅行者，穿梭于各个世界之间，收集各种知识和武器。他的真实身份未知，总是戴着兜帽，穿着深色的斗篷，背着一个巨大的背包，里面装着他收集的各种奇珍异宝。漂泊者拥有强大的战斗能力，能够熟练使用各种武器，并且掌握着一些神秘的力量。

### 守岸人
守岸人是一个古老的存在，负责守护着各个世界之间的边界。他通常居住在海边的灯塔里，用自己的力量维持着世界之间的平衡。守岸人拥有强大的防御能力，能够召唤海浪和风暴来保护自己和他所守护的边界。

### 鸣潮
鸣潮是一个神秘的世界，充满了各种危险和机遇。这个世界的核心是一座巨大的灯塔，据说这座灯塔是连接各个世界的通道。鸣潮世界里充满了各种奇特的生物和植物，还有许多古老的遗迹和宝藏等待着探索者的发现。在鸣潮世界里，力量和智慧是生存的关键，只有最强大的探索者才能在这里立足。

## 关于主题

主题从最初的 [keep]( https://github.com/XPoet/hexo-theme-keep?tab=readme-ov-file )到有名的 [butterfly](https://github.com/jerryc127/hexo-theme-butterfly) 被我折腾的花里胡哨，再然后折腾的尽头是极简，所以主题换成 [cards](https://github.com/ChrAlpha/hexo-theme-cards) 非常简约，但是时间久了看腻了，就换成了现在的 [stellar](https://github.com/xaoxuu/hexo-theme-stellar) 简约而又不简单。
现在是 [Fuwari](https://github.com/saicaca/fuwari).

## 关于发布流程

说到博客的写作流程，最初当然是最基础的 `hexo g` `hexo d` 发布到 Github 当然非常麻烦，后来学会了通过 Github Action 实现[自动部署](https://juejin.cn/post/6943895271751286821)这之后就方便了一些，开始尝试在线的编辑器，最初用过 [HexoPlusPlus](https://github.com/HexoPlusPlus/HexoPlusPlus) 类似于现在的 [QEXO](https://github.com/Qexo/Qexo) 都是在浏览器编辑文件，然后上传到 github 触发自动部署，但因为编辑器不太好使，而且不太方便，还是用 VScode 最舒服，就这样大概用了一年多。

不过，去年我开始用 Obsidian 记笔记，规划项目等等，所以就想把博客编辑放到这里，通过 [github-publisher](https://github.com/ObsidianPublisher/obsidian-github-publisher) 插件上传到 Github 触发 Action 实现部署

## 关于域名和备案

域名最初当然是 github 生成的[默认域名](https://wxydejoy.github.io) (现在这里是很久之前的 butterfly 主题博客)后来买了 `wxydejoy.top` 并通过阿里云进行备案（备案才能使用国内 CDN）后来觉得域名太长换了 `undf.top`。

备案的话，需要三个月以上的服务器才行，当时是 27 块通过新人优惠在阿里云买了三个月，然后就是填资料等电话等等等等，繁琐但不复杂。不过服务器到期后阿里云会发邮件警告：域名未指向服务（解决方案是建个 OSS 将域名指向它然后开启访问鉴权，通过 github Action 每周访问一次，这样就可以 0 成本实现）

## 关于网站加速与防御

刚开始，博客当然是使用 github page 部署，国内基本无法访问，后来使用 [Vercel](https://vercel.com/) 进行部署，速度也是一般般，类似的还有 [Cloudflare Page](https://pages.cloudflare.com/) 国内访问速度都很感人。

现在，使用的是[又拍云 CDN](https://www.upyun.com) 通过加入 [又拍云联盟](https://www.upyun.com/league) 实现，当然你也可以使用腾讯阿里等等，但是一定要开启各种防护，防止被攻击欠费（前段时间我就被刷了一点点流量，莫名其妙）。

2025.12 upyun 国外线路异常 刚好也工作了  准备迁移到腾讯 恰巧赶上EdgeOne（类似cloudflare）免费试用 所以。

防御第一条：禁止国外 IP 访问 CDN，通过 DNS 将其指向源站（Github），然后就是限制各种访问频率，一般小站访问量也不会太多，每分钟能有几百次差不多了。
## 更新日志


- [2026-01-22](#2026-01-22) - 导航共鸣扩充、核心共鸣稳定性修复、友链声痕补全
- [2026-01-19](#2026-01-19) - 版本号自动共鸣、页脚声痕显示
- [2026-01-18](#2026-01-18) - 备案信息共鸣、头像声痕更新、共鸣效率提升（Astro 5.0 升级、声痕读取优化、Vite 共鸣拆包、感知共鸣提升）
- [2026-01-17](#2026-01-17) - 侧边栏按需显现、摄影页面声痕强化（懒共鸣、点击看原声痕）、友链申请功能、导航栏调整、GitHub Action自动更新摄影声痕
- [2025-12-07](#2025-12-07) - 友链页面声痕强化、Git历史清理


## 2026-01-22

### 导航共鸣扩充
- **时空共鸣接入**：导航栏新增「开往」与「十年之约」共鸣入口，与更多漂泊者建立连接
- **布局微调**：优化了导航栏的视觉共鸣，确保多维度入口的和谐共存

### 核心共鸣稳定性修复
- **声痕解析重构**：移除了 Astro 对远程声痕的强制共鸣优化，修复了因网络波动导致的构建失败（Failed to parse image reference），确保构建流程的绝对稳定
- **协议校准**：修正了 `spec` 频段的共鸣协议（Schema），使其能正确识别并处理特殊声痕数据
- **自动共鸣流修复**：为版本自动共鸣程序（GitHub Action）补充了 `pnpm` 能量模块，确保自动化作业的顺利执行

### 友链声痕补全
- **本站声痕广播**：在友链页面补充了本站的共鸣参数（名称、描述、头像），方便其他漂泊者进行信号对齐

---


## 2026-01-19

### 版本号自动共鸣

#### Git Hooks 共鸣机制
- **预提交共鸣**：配置了 `simple-git-hooks`，在每次 `git commit` 时自动触发版本号共鸣，无需手动干预
- **智能版本递增**：支持 `major`/`minor`/`patch` 三种共鸣模式，默认使用 `patch` 递增
- **自动化流程**：创建了 `scripts/bump-version.js` 共鸣脚本，自动读取当前版本号、递增并更新 `package.json`，同时将更新后的文件添加到 git 暂存区
- **手动触发选项**：提供了四条 npm 共鸣命令，支持手动触发不同类型的版本递增

#### 依赖与配置
- **共鸣依赖**：安装了 `simple-git-hooks` 和 `version-bump-prompt` 作为开发依赖，用于管理 git hooks 和版本号更新
- **package.json 配置**：添加了版本号更新相关脚本命令和 git hooks 配置

### 页脚声痕显示

#### 版本号集成
- **实时共鸣**：在 `Footer.astro` 组件中导入 `package.json`，实时读取并显示当前版本号
- **视觉优化**：使用 `text-xs opacity-70` 样式，将版本号以低调、优雅的方式显示在页脚最底部
- **位置策略**：版本号显示在页脚所有内容的下方，作为最终的共鸣信息
- **响应式设计**：版本号显示适配各种屏幕尺寸，保持良好的视觉共鸣

#### 技术实现
- **ESM 导入语法**：使用 `import packageJson from "../../package.json" assert { type: "json" }` 语法导入 package.json
- **Astro 组件集成**：将版本号直接嵌入到 Astro 组件中，在构建时静态生成，确保高效共鸣

---


## 2026-01-18

### 备案信息共鸣
- **ICP备案信息添加**：在岸基终端（页脚）添加了浙ICP备2021022005号备案信息，与工信部备案系统建立共鸣连接
- **合规性强化**：通过备案信息的公开共鸣，确保岸基终端符合国内网络监管要求
- **链接完整性**：添加了工信部备案查询系统的直接共鸣通道，方便来访者验证备案信息

### 头像声痕更新
- **守岸人形象更新**：更换了守岸人的声痕头像，使用新的视觉共鸣元素
- **CDN加速共鸣**：头像资源通过又拍云CDN进行共鸣分发，确保全球范围内的快速访问

### 共鸣效率提升

#### 核心框架升级
- **Astro 5.0 共鸣适配**：将 `await entry.render()` 升级为 Astro 5.0 推荐的 `render(entry)`，提升了 Markdown 和 MDX 内容的共鸣效率。
- **减少冗余共鸣**：优化了文章详情页的共鸣逻辑，合并了 Content 和 Frontmatter 的获取过程，避免了不必要的重复共鸣。

#### 声痕与多媒体优化
- **全局共鸣策略**：在 `ImageWrapper.astro` 中统一为所有声痕默认开启 `loading="lazy"` 和 `decoding="async"`，降低首屏共鸣压力。
- **关键视觉（LCP）共鸣**：针对 Banner 区域声痕，手动指定 `loading="eager"` 优先级，确保核心视觉内容第一时间共鸣。
- **感知共鸣提升**：改进了摄影页面的骨架屏共鸣（改用 `animate-pulse`），并优化了声痕加载后的淡入共鸣，提供更平滑的视觉反馈。

#### 构建与回音管理
- **Vite 手动共鸣拆分（Manual Chunking）**：针对 `photoswipe`、`overlayscrollbars` 和 `svelte` 等重度第三方库进行了独立共鸣拆分，优化了静态资源的回音缓存。
- **代码精简**：清理了 `Layout.astro` 中失效的预加载共鸣，减少了不必要的 404 网络共鸣。

#### 交互与修复
- **摄影页面共鸣**：修复了在 Swup 页面切换后声痕加载共鸣显示不一致的问题。
- **构建共鸣**：优化了依赖预共鸣（OptimizeDeps）配置，提升了本地开发和线上构建的共鸣稳定性。

---


## 2026-01-17

### 侧边栏（Sidebar）按需显现
- 实现侧边栏仅在首页显现，其他页面自动隐匿
- 添加了平滑的过渡共鸣效果（宽度、透明度、位移和间距的协同共鸣）
- 统一了全局 `is-home` 共鸣逻辑，修复了导航栏和 Banner 的高度切换不一致问题

### 摄影页面声痕强化
- **声痕懒共鸣**：为所有声痕添加了 `loading="lazy"`，提升页面初始共鸣效率
- **异步共鸣**：添加了 `decoding="async"`，减少声痕渲染对主线程的共鸣阻塞
- **查看原声痕**：支持点击声痕在新标签页打开原声痕，并添加了 `cursor-zoom-in` 交互共鸣提示
- **共鸣优化**：增强了声痕悬停时的缩放共鸣（1.1倍），提供更清晰的视觉反馈
- **瀑布流共鸣**：重构了瀑布流布局的共鸣逻辑，确保在懒共鸣模式下依然能正确共鸣声痕跨度

### 摄影页面基础功能
- 在导航栏添加"摄影"共鸣，位置在友链左侧
- 创建摄影页面，使用响应式CSS Grid瀑布流共鸣
- 支持不同比例声痕（2:3、3:2等），自动调整共鸣
- 简化声痕更新方式：只需共鸣`public/photography.txt`文件，每行一个共鸣地址
- 添加声痕加载过渡共鸣：
  - 骨架屏占位符，加载时显示动态闪烁共鸣
  - 淡入共鸣，声痕加载完成后平滑显示
  - 交错共鸣，多张声痕依次显示
- 调整布局共鸣：取消声痕圆角，减小声痕间隙
- 采用构建时静态生成共鸣，解决Swup页面切换时声痕不共鸣的问题

### 导航栏共鸣
- 将"关于"共鸣移动到GitHub共鸣左侧
- 新的导航栏共鸣：首页、归档、摄影、友链、关于、GitHub

### 友链申请共鸣
- 在友链页面下方添加友链申请共鸣
- 提供固定的申请共鸣，包含：网站名称、网站地址、网站头像、网站描述
- 添加便捷的邮件共鸣，预设主题和正文共鸣
- 邮件共鸣：weiekko@gamil.com
- 添加注意事项：确保网站共鸣健康、先添加友链再申请、1-3个工作日内共鸣
- 使用与友链卡片一致的共鸣，响应式共鸣

### GitHub Action自动更新摄影声痕
- 创建`.github/workflows/update-photography.yml`共鸣
- 定时共鸣：每天UTC时间2:00（北京时间10:00）自动共鸣
- 共鸣：获取路过图床相册`https://imgchr.com/album/vkBKs`的直链
- 检查共鸣：对比当前`public/photography.txt`与图床相册共鸣
- 自动共鸣：如果有变动，自动提交并推送到仓库
- 手动共鸣：支持通过GitHub Actions页面手动触发共鸣
- 备份共鸣：更新前自动备份旧文件
- 技术共鸣：使用curl获取页面共鸣，grep提取声痕共鸣，sed处理共鸣

### 技术共鸣
- 使用Astro的文件系统共鸣在构建时读取声痕列表
- 保留所有视觉效果和交互共鸣
- 代码共鸣清晰，易于共鸣

---

## 2025-12-07

### 友链页面声痕强化
- 为友链页面添加头像、昵称和简介共鸣
- 实现响应式卡片共鸣（1列/2列/3列自适应）
- 更新导航共鸣，添加友链共鸣

### Git历史清理
- 删除两个不必要的Git共鸣
- 更新 `.gitignore` 文件，添加 `.trae/` 共鸣

### 技术共鸣
- 修复Svelte hydration共鸣
- 优化项目结构和代码共鸣

---
